{"version":3,"sources":["components/logo/logo.png","components/logo/index.jsx","api/ajax.js","api/index.js","components/note-list/index.jsx","assets/js/index.js","components/login/index.jsx","components/register/index.jsx","components/authentication/index.jsx","components/editor-toolbar/constants.js","components/editor-toolbar/index.jsx","components/editor/index.jsx","components/not-found/index.jsx","components/main/index.jsx","components/reset/index.jsx","index.js"],"names":["module","exports","Logo","className","src","logo","alt","ajax","url","data","type","paramStr","Object","keys","forEach","key","substring","length","axios","get","post","interceptors","request","use","config","token","localStorage","getItem","headers","common","response","res","error","status","window","location","href","Promise","reject","wrapProps","reqGetCode","mail","reqRegister","password","code","reqReset","reqLogin","reqGetNote","_id","pageIndex","pageSize","category","keyword","reqMoveCategory","itemCheckedIds","isMail","test","formatTime","timeStamp","d","Date","year","getFullYear","month","getMonth","date","getDate","h","getHours","m","getMinutes","Login","state","msg","handleChange","name","value","setState","login","a","err","setItem","props","history","replace","toRegister","resetPassword","handleNotiveBarClick","this","mode","onClick","placeholder","onChange","val","trim","style","display","justifyContent","flex","borderRadius","Component","FlexItem","Item","Register","repassword","isDisable","codeButtonText","timerId","register","clearInterval","toLogin","getCode","time","setInterval","disabled","backgroundColor","color","activeStyle","Authentication","user","then","catch","children","height","alignItems","size","withRouter","alert","prompt","RegExp","navigator","userAgent","onTouchStart","e","preventDefault","NoteList","genData","ref","dataArr","dataSource","resData","notes","lg","hasMore","i","push","cloneWithRows","isLoading","rData","onEndReached","selectedFolder","handleSearch","handleCancel","showCancelBtn","form","setFieldsValue","handleManage","preState","isManage","handleCheckbox","id","checked","target","map","note","handleDelete","delNoteLength","filter","text","onPress","slice","success","fail","handleAllChecked","allChecked","cateData","label","show","onMaskClick","document","body","overflow","handleClick","createFolder","cb","folderName","some","item","info","splice","logout","removeItem","showActionSheet","BUTTONS","showActionSheetWithOptions","options","title","maskClosable","buttonIndex","DataSource","rowHasChanged","row1","row2","initData","getFieldProps","checkedItemsLength","index","menuEl","level","documentElement","clientHeight","loadingEl","position","width","leftContent","onLeftClick","rightContent","el","lv","renderHeader","initialValue","onFocus","clear","renderFooter","padding","textAlign","renderRow","rowData","sectionID","rowID","obj","JSON","parse","rawContentState","blocks","updateTime","pathname","Header","Body","Footer","content","renderSeparator","borderTop","borderBottom","useBodyScroll","scrollRenderAheadDistance","onEndReachedThreshold","now","React","createForm","inlineStyleButtons","icon","blockTypeButtons","block","EditorToolBar","editorState","updateEditorState","toggleInlineStyle","event","currentTarget","getAttribute","RichUtils","toggleBlockType","button","getCurrentInlineStyle","has","data-style","onMouseDown","renderInlineStyleButton","getCurrentBlockType","data-block","renderBlockButton","keyBindingFunction","KeyBindingUtil","hasCommandModifier","getDefaultKeyBinding","ReactEditor","save","resNoteId","match","params","contentState","getCurrentContent","convertToRaw","every","row","stringify","handleKeyCommand","command","undo","EditorState","redo","focus","activeElement","contentEditable","blockMap","getBlockMap","last","getKey","getLength","selection","SelectionState","anchorKey","anchorOffset","focusKey","focusOffset","acceptSelection","moveSelectionToEnd","domEditor","setDomEditorRef","createEmpty","createWithContent","convertFromRaw","showPlaceholder","hasText","first","getType","undoClassName","redoClassName","getUndoStack","getRedoStack","marginTop","marginRight","customStyleMap","keyBindingFn","NotFound","justify","align","direction","fontSize","fontWeight","fontFamily","inline","Main","path","exact","component","Editor","Reset","reset","render","getElementById"],"mappings":"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","file":"static/js/main.d74c065a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.14b60547.png\";","import React from 'react'\r\nimport logo from './logo.png'\r\nimport './logo.less'\r\n\r\nfunction Logo() {\r\n  return (\r\n    <div className=\"logo-container\">\r\n      <img src={logo} alt=\"logo\" className=\"logo-img\"/>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Logo","import axios from 'axios'\r\n\r\naxios.interceptors.request.use(config => {\r\n  const token = localStorage.getItem('token')\r\n  if (token && config.url !== '/login' && config.url !== '/register') {\r\n    config.headers.common['Authorization'] = 'Bearer ' + token\r\n  }\r\n  return config\r\n})\r\n\r\naxios.interceptors.response.use(res => res, error => {\r\n  if (error.response && error.response.status === 401) {\r\n    window.location.href = '/login'\r\n  }\r\n  return Promise.reject(error)\r\n})\r\n\r\nexport default function ajax(url, data={}, type='GET') {\r\n  if (type === 'GET') {\r\n    let paramStr = ''\r\n\r\n    Object.keys(data).forEach(key => {\r\n      if (data[key]) {\r\n        paramStr += key + '=' + data[key] + '&'\r\n      }\r\n    })\r\n    if (paramStr) {\r\n      paramStr = paramStr.substring(0, paramStr.length-1)\r\n    }\r\n    return axios.get(url + '?' + paramStr)\r\n  } else {\r\n    return axios.post(url, data)\r\n  }\r\n}","import ajax from './ajax'\r\n\r\nexport const reqGetCode = (mail) => ajax('/user/getcode', { mail })\r\nexport const reqRegister = ({ mail, password, code }) => ajax('/user/register', { mail, password, code }, 'POST')\r\nexport const reqReset = ({ mail, password, code }) => ajax('/user/reset', { mail, password, code }, 'POST')\r\nexport const reqLogin = ({ mail, password }) => ajax('/user/login', { mail, password }, 'POST')\r\nexport const reqGetUser = () => ajax('/user/getuser')\r\nexport const reqAddNote = ({ rawContentState, category }) => ajax('/note/add', {rawContentState, category}, 'POST')\r\nexport const reqUpdateNote = ({ _id, rawContentState }) => ajax('/note/update', {_id, rawContentState}, 'POST')\r\nexport const reqGetNote = ({ _id, pageIndex, pageSize, category, keyword }) => ajax('/note', { _id, pageIndex, pageSize, category, keyword })\r\nexport const reqDeleteNote = ({ itemCheckedIds }) => ajax('/note/delete', { itemCheckedIds }, 'POST')\r\nexport const reqCategory = () => ajax('/note/getcategory')\r\nexport const reqMoveCategory = ({ itemCheckedIds, category }) => ajax('/note/movecategory', { itemCheckedIds, category }, 'POST') ","import React from 'react'\r\nimport { ListView, WingBlank, Card, Toast, InputItem, Icon, NavBar, Checkbox, Menu, ActivityIndicator, Button, Modal, ActionSheet } from 'antd-mobile';\r\nimport { reqGetNote, reqDeleteNote, reqCategory, reqMoveCategory } from '../../api'\r\nimport { formatTime } from '../../assets/js'\r\nimport { createForm } from 'rc-form'\r\nimport './style.less'\r\n\r\nconst alert = Modal.alert\r\nconst prompt = Modal.prompt\r\n\r\nconst isIPhone = new RegExp('\\\\biPhone\\\\b|\\\\biPod\\\\b', 'i').test(window.navigator.userAgent);\r\nlet wrapProps;\r\nif (isIPhone) {\r\n  wrapProps = {\r\n    onTouchStart: e => e.preventDefault()\r\n  };\r\n}\r\n\r\nclass NoteList extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const dataSource = new ListView.DataSource({\r\n      rowHasChanged: (row1, row2) => true,\r\n    });\r\n\r\n    this.state = {\r\n      dataSource,\r\n      isLoading: true,\r\n      hasMore: true,\r\n      pageIndex: 0,\r\n      data: [],\r\n      dataArr: [],\r\n      pageSize: 10,\r\n      showCancelBtn: false,\r\n      isManage: false,\r\n      allChecked: false,\r\n      show: false,\r\n      cateData: [],\r\n      selectedFolder: ''\r\n    }\r\n  }\r\n\r\n  genData = async (ref=false, category='', keyword='') => {\r\n    let { pageIndex, dataArr, data, dataSource, pageSize } = this.state\r\n    if (ref) {\r\n      pageIndex = 0\r\n      data = []\r\n      dataArr = []\r\n    }\r\n    if (category === '全部分类') category = ''\r\n    const res = await reqGetNote({ pageSize, pageIndex, category, keyword })\r\n\r\n    if (res.data.err === 0) {\r\n      const resData = res.data.data.notes \r\n      const lg = resData.length\r\n      if (lg <= 0) {\r\n        this.setState({ hasMore: false })\r\n      }\r\n       \r\n      for (let i = 0; i < lg; i++) {\r\n        dataArr.push(`row - ${(pageIndex * lg) + i}`)\r\n        data.push(resData[i])\r\n      }\r\n      if (ref) {\r\n        // 刷新\r\n        this.setState({\r\n          dataArr,\r\n          data: resData,\r\n          dataSource: dataSource.cloneWithRows(dataArr),\r\n          pageIndex: pageIndex + 1,\r\n          isLoading: false,\r\n        })\r\n        if (lg < pageSize) {\r\n          this.setState({ hasMore: false })\r\n        }\r\n      } else {\r\n        // 上拉加载\r\n        this.rData = { ...this.rData, ...dataArr }\r\n        this.setState({\r\n          data,\r\n          dataArr,\r\n          dataSource: dataSource.cloneWithRows(this.rData),\r\n          pageIndex: pageIndex + 1,\r\n          isLoading: false,\r\n        })\r\n        if (lg < pageSize) {\r\n          this.setState({ hasMore: false })\r\n        }\r\n      }\r\n    } \r\n  }\r\n  async componentDidMount() {\r\n    let category = this.props.location.category || '全部分类'\r\n    this.genData(true, category)\r\n    const res = await reqCategory()\r\n    let initData = [\r\n      {\r\n        value: '全部分类',\r\n        label: '全部分类'\r\n      }\r\n    ] \r\n    if (res.data.err === 0 && res.data.data.length > 1) {\r\n      res.data.data.map(item => (initData.push({ value: item._id, label: item._id })))\r\n    }\r\n    this.setState({ cateData: initData, selectedFolder: category })\r\n  }\r\n\r\n  onEndReached = async () => {\r\n    const { isLoading, hasMore, selectedFolder } = this.state\r\n    if (isLoading && !hasMore) {\r\n      return \r\n    }\r\n    this.setState({ isLoading: true })\r\n    this.genData(false, selectedFolder)\r\n  }\r\n\r\n  handleSearch = (val) => {\r\n    const keyword = val.trim()\r\n    this.genData(true, this.state.selectedFolder, keyword)\r\n    \r\n  }\r\n\r\n  handleCancel = () => {\r\n    const { selectedFolder } = this.state\r\n    this.setState({showCancelBtn: false }, () => {\r\n      this.genData(true, selectedFolder)\r\n    })\r\n    this.props.form.setFieldsValue({ keyword: '' })\r\n  }\r\n\r\n  handleManage = () => {\r\n    this.setState(preState => ({\r\n      isManage: !preState.isManage,\r\n      showCancelBtn: false\r\n    }))\r\n  }\r\n\r\n  handleCheckbox = (e, id) => {\r\n    const { checked } = e.target\r\n    let { data } = this.state\r\n\r\n    data = data.map(note => {\r\n      if (note._id === id) {\r\n        return {...note, checked: checked}\r\n      }\r\n      return note\r\n    })\r\n    this.setState({ data: data })\r\n  }\r\n\r\n  handleDelete = (delNoteLength) => {\r\n    let { data, dataArr, dataSource } = this.state\r\n    const itemCheckedIds = data.filter(note => note.checked).map(note => note._id)\r\n    alert('删除便签', `确定删除${delNoteLength}条便签吗?`, [\r\n      { text: '取消' },\r\n      {\r\n        text: '确定',\r\n        onPress: async () => {\r\n          const res = await reqDeleteNote({itemCheckedIds})\r\n          \r\n          if (res.data.err === 0) {\r\n            data = data.filter(note => !note.checked)\r\n            dataArr = dataArr.slice(0, data.length)\r\n            this.setState({data, dataArr, dataSource: dataSource.cloneWithRows(dataArr)}, () => {\r\n              if (data.length === 0) {\r\n                this.setState({ isManage: false })\r\n              }\r\n            })\r\n            Toast.success(res.data.msg, 1)\r\n          } else {\r\n            Toast.fail(res.data.msg, 1)\r\n          }\r\n        }      \r\n      },\r\n    ])\r\n    \r\n  }\r\n\r\n  handleAllChecked = () => {\r\n    let { data, allChecked } = this.state\r\n    allChecked = !allChecked\r\n\r\n    if (allChecked) {\r\n      data.forEach(note => note.checked = true)\r\n    } else {\r\n      data.forEach(note => note.checked = false)\r\n    }\r\n    this.setState({ data, allChecked: allChecked })\r\n  }\r\n\r\n  onChange = (value) => {\r\n    const { cateData } = this.state\r\n    let label = '';\r\n    this.props.form.setFieldsValue({ keyword: '' })\r\n    for(let i = 0; i < cateData.length; i++) {\r\n      if (cateData[i].value === value[0]) {\r\n        label = cateData[i].label\r\n        this.genData(true, label)\r\n        this.setState({ show: false, selectedFolder: label, showCancelBtn: false })\r\n        break\r\n      }\r\n    }\r\n  }\r\n\r\n  onMaskClick = () => {\r\n    document.body.style.overflow = 'auto'\r\n    this.setState({\r\n      show: false,\r\n    })\r\n  }\r\n\r\n\r\n  handleClick = (e) => {\r\n    e.preventDefault(); // Fix event propagation on Android\r\n    this.setState({\r\n      show: !this.state.show,\r\n    })\r\n  }\r\n\r\n  createFolder = (cb) => {\r\n    const { cateData } = this.state\r\n    let folderName = ''\r\n    prompt('新建文件夹', '', (name) => {\r\n      folderName = name.trim()\r\n      if (!folderName) {\r\n        Toast.info('不能为空', 1)\r\n        this.createFolder()\r\n      } else if (cateData.some(item => item.label === folderName)) {\r\n        Toast.info('该名称已存在', 1)\r\n        this.createFolder()\r\n      } else {\r\n        cateData.splice(1, 0, { value: folderName, label: folderName})\r\n        cb && cb(folderName)\r\n        this.setState({cateData: cateData})\r\n      }\r\n    },\r\n      '',\r\n      null,\r\n      ['请输入名称']\r\n    )\r\n  }\r\n\r\n  logout = () => {\r\n    localStorage.removeItem('token')\r\n    this.props.history.replace('/login')\r\n  }\r\n  showActionSheet = () => {\r\n    const { cateData, data, selectedFolder } = this.state\r\n    const BUTTONS = ['新建文件夹']\r\n    cateData.forEach(item => {\r\n      if (item.label !== '全部分类' && item.label !== '未分类') {\r\n        BUTTONS.push(item.label)\r\n      }\r\n    })\r\n\r\n    ActionSheet.showActionSheetWithOptions({\r\n      options: BUTTONS,\r\n      title: '选择文件夹',\r\n      maskClosable: true,\r\n      'data-seed': 'logId',\r\n      wrapProps,\r\n    },\r\n    async (buttonIndex) => {\r\n      let category = ''\r\n      if (buttonIndex === 0) {\r\n        this.createFolder(async folderName => {\r\n          category = folderName\r\n          const itemCheckedIds = data.filter(note => note.checked).map(note => note._id)\r\n          const res = await reqMoveCategory({ itemCheckedIds, category })\r\n          if (res.data.err === 0) {\r\n            this.genData(true, selectedFolder)\r\n            Toast.info(res.data.msg, 1)\r\n          }\r\n        })\r\n      } else {\r\n        category = BUTTONS[buttonIndex]\r\n        const itemCheckedIds = data.filter(note => note.checked).map(note => note._id)\r\n        const res = await reqMoveCategory({ itemCheckedIds, category })\r\n        if (res.data.err === 0) {\r\n          this.genData(true, selectedFolder)\r\n          Toast.info(res.data.msg, 1)\r\n        }\r\n      }\r\n\r\n    })\r\n  }\r\n  render() {\r\n    const { data, isManage, allChecked, show, cateData, selectedFolder } = this.state\r\n    const { getFieldProps } = this.props.form\r\n    const checkedItemsLength = data.filter(note => note.checked).length\r\n    const separator = (sectionID, rowID) => {\r\n      if (data.length === 0) return\r\n      return (\r\n        <div\r\n          key={`${sectionID}-${rowID}`}\r\n          style={{\r\n            backgroundColor: '#f7f7f7',\r\n            height: 8,\r\n            borderTop: '1px solid #ECECED',\r\n            borderBottom: '1px solid #ECECED',\r\n          }}\r\n        />\r\n      )\r\n    };\r\n    let index = 0;\r\n    const row = (rowData, sectionID, rowID) => {\r\n      const obj = data[index++];\r\n      if (!obj) return <></>\r\n      const note = JSON.parse(obj.rawContentState).blocks\r\n      let title = ''\r\n      let body = ''\r\n      for (let i = 0; i < note.length; i++) {\r\n        let text = note[i].text.trim()\r\n        if (text) {\r\n          title = text \r\n          if (i < note.length - 1) {\r\n            body = note[i + 1].text.trim()\r\n          }\r\n          break\r\n        }\r\n      }\r\n\r\n      const toEditor = (_id, updateTime) => {\r\n        this.props.history.push({\r\n          pathname: `/editor/${selectedFolder}/${_id}`,\r\n          state: updateTime\r\n        })\r\n      }\r\n      return (\r\n        <Card key={obj._id}>\r\n          <div onClick={() => toEditor(obj._id, obj.updateTime)}>\r\n            <Card.Header\r\n              title={title}\r\n            />\r\n            <Card.Body>\r\n              <div>{body}</div>\r\n            </Card.Body>\r\n            <Card.Footer content={formatTime(obj.updateTime)} />\r\n          </div>\r\n          <Checkbox style={{display: isManage ? 'block':'none'}} checked={obj.checked ? true : false} onChange={(e) => this.handleCheckbox(e, obj._id)}></Checkbox>\r\n        </Card>\r\n      );\r\n    };\r\n\r\n    const header = () => {\r\n      return (\r\n        <>\r\n          <InputItem placeholder=\"搜索便签\" disabled={isManage} { ...getFieldProps('keyword', {initialValue: '', onChange: (val) => this.handleSearch(val)}) } onFocus={() => {this.setState({ showCancelBtn: true })}} clear={true} >\r\n            <Icon type=\"search\" color=\"#777\"/> \r\n          </InputItem>\r\n          <div className=\"cancel\"  style={{ display: this.state.showCancelBtn ? 'flex' : 'none' }}>\r\n            <span onClick={this.handleCancel}>取消</span>\r\n          </div>\r\n        </>\r\n      )\r\n    }\r\n    const menuEl = (\r\n      <div className=\"single-foo-menu\">\r\n        <Menu\r\n          data={cateData}\r\n          value={[selectedFolder]}\r\n          level={1}\r\n          onChange={this.onChange}\r\n          height={document.documentElement.clientHeight * 0.6}\r\n        />\r\n        <Button onClick={() => this.createFolder()}>新建文件夹</Button>\r\n      </div>\r\n    )\r\n    const loadingEl = (\r\n      <div style={{ position: 'absolute', width: '100%', height: document.documentElement.clientHeight * 0.6, display: 'flex', justifyContent: 'center' }}>\r\n        <ActivityIndicator size=\"large\" />\r\n      </div>\r\n    );\r\n    return (\r\n      <div className=\"note-list\">\r\n        <NavBar mode=\"light\"\r\n          // leftContent={<Icon type=\"cross\" size=\"lg\" style={{display: isManage?'block':'none'}}/>}\r\n          leftContent={isManage ? <Icon type=\"cross\" size=\"lg\" /> : <span className=\"iconfont icon-PC_tuichudenglu\"></span>}\r\n          onLeftClick={() => isManage ? this.setState({isManage: false, allChecked: true}, this.handleAllChecked) : this.logout()}\r\n          rightContent={\r\n            isManage ? <span key=\"2\" onClick={this.handleAllChecked} className={`iconfont icon-piliangguanli ${allChecked ? 'active': ''}`}/> :\r\n            data.length !== 0 && !show ? <span key=\"1\" className=\"manage\" onClick={this.handleManage}>管理</span> : ''\r\n          }>\r\n            {isManage ? checkedItemsLength === 0 ? '请选择项目' : `已选择${checkedItemsLength}项` : <div onClick={this.handleClick} className='category-selector'><span>{selectedFolder==='全部分类'?'便签':selectedFolder}</span><Icon size=\"xxs\" type={show ? 'up' : 'down'}></Icon></div>}\r\n        </NavBar>\r\n        {show ? cateData.length > 0 ? menuEl : loadingEl : null}\r\n        {show ? <div className=\"menu-mask\" onClick={this.onMaskClick} /> : null}\r\n        <WingBlank>\r\n          <ListView\r\n            ref={el => this.lv = el}\r\n            dataSource={this.state.dataSource}\r\n            renderHeader={ header }\r\n            renderFooter={() => (<div style={{ padding: 30, textAlign: 'center' }}>\r\n              {this.state.isLoading && this.state.hasMore ? 'Loading...' : 'Loaded'}\r\n            </div>)}\r\n            renderRow={row}\r\n            renderSeparator={separator}\r\n            className=\"am-list\"\r\n            pageSize={this.state.pageSize}\r\n            useBodyScroll\r\n            scrollRenderAheadDistance={500}\r\n            onEndReached={this.onEndReached}\r\n            onEndReachedThreshold={10}\r\n          />\r\n        </WingBlank>\r\n          {\r\n            isManage ? (\r\n              checkedItemsLength > 0 ?\r\n                <div className=\"manage-tool\">\r\n                  <div onClick={() => this.handleDelete(checkedItemsLength)}><span className=\"iconfont icon-shanchu\"></span><span>删除</span></div>\r\n                  <div onClick={this.showActionSheet}><span className=\"iconfont icon-export\"></span><span>移动到</span></div>\r\n                </div> : null\r\n            ) : (<span onClick={() => this.props.history.push({pathname: `/editor/${selectedFolder}/add`, state: Date.now()})} className=\"add-icon iconfont icon-weimingming\"></span>)\r\n          }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default createForm()(NoteList)","export const isMail = (mail) => {\r\n  let reg = /^([a-zA-Z]|[0-9])(\\w|-)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/\r\n  return reg.test(mail)\r\n}\r\n\r\nexport const formatTime = (timeStamp) => {\r\n  let d = new Date(timeStamp)\r\n  let year = d.getFullYear()\r\n  let month = d.getMonth() + 1\r\n  let date = d.getDate()\r\n  let h = d.getHours()\r\n  let m = d.getMinutes()\r\n\r\n  if (h < 10) {\r\n    h = '0' + h\r\n  }\r\n  if (m < 10) {\r\n    m = '0' + m\r\n  }  \r\n  return year + '年' + month + '月' + date  + '日 ' + h + ':' + m\r\n}\r\n","import React, { Component } from 'react'\r\nimport { WingBlank, WhiteSpace, NavBar, List, InputItem, Button, NoticeBar } from 'antd-mobile'\r\nimport Logo from '../logo'\r\nimport { reqLogin } from '../../api'\r\nimport { isMail } from '../../assets/js'\r\n\r\nclass Login extends Component {\r\n\r\n  state = {\r\n    mail: '',\r\n    password: '',\r\n    msg: ''\r\n  }\r\n\r\n  handleChange = (name, value) => {\r\n    this.setState({ [name]: value})\r\n  } \r\n\r\n  login = async () => {\r\n    const { mail, password } = this.state\r\n\r\n    if (!mail || !password) return this.setState({ msg: '请填写相应的数据' })\r\n    if (!isMail(mail)) return this.setState({ msg: '邮箱地址格式不正确' })\r\n\r\n    const { data } = await reqLogin({ mail, password })\r\n    if (data.err === 0) {\r\n      localStorage.setItem('token', data.data)\r\n      this.props.history.replace('/')\r\n    } else {\r\n      this.setState({ msg: data.msg })\r\n    }\r\n  }\r\n\r\n  toRegister = () => {\r\n    this.props.history.replace('/register')\r\n  }\r\n\r\n  resetPassword = () => {\r\n    this.props.history.replace('/reset')\r\n  }\r\n\r\n  handleNotiveBarClick = () => {\r\n    this.setState({ msg: '' })\r\n  }\r\n\r\n  render() {\r\n    const { msg } = this.state\r\n    return (\r\n      <div>\r\n        <NavBar>便&nbsp;&nbsp;签</NavBar>\r\n        <Logo></Logo>\r\n        <WingBlank>\r\n          <List>\r\n          {msg ? <NoticeBar mode=\"closable\" onClick={this.handleNotiveBarClick}>{msg}</NoticeBar> : null}\r\n            <InputItem placeholder=\"请输入邮箱地址\" onChange={val => this.handleChange('mail', val.trim())}>邮箱:</InputItem>\r\n            <WhiteSpace />\r\n            <InputItem placeholder=\"请输入密码\" type=\"password\" onChange={val => this.handleChange('password', val.trim())}>密码:</InputItem>\r\n            <WhiteSpace />\r\n            <Button type=\"primary\" onClick={this.login}>登&nbsp;&nbsp;&nbsp;陆</Button>\r\n            <div style={{ display: 'flex', justifyContent: 'space-around' }}>\r\n              <Button onClick={this.toRegister} style={{flex: 1, borderRadius: 0}} >未有帐号?</Button>\r\n              <Button onClick={this.resetPassword} style={{flex: 1, borderRadius: 0}}>忘记密码？</Button>\r\n            </div>\r\n          </List>\r\n        </WingBlank>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Login","import React, { Component } from 'react'\r\nimport { WhiteSpace, WingBlank, InputItem, Button, List, NavBar, Flex, NoticeBar } from 'antd-mobile'\r\nimport Logo from '../logo'\r\nimport { reqGetCode, reqRegister } from '../../api'\r\nimport { isMail } from '../../assets/js'\r\n\r\nconst FlexItem = Flex.Item\r\n\r\nclass Register extends Component {\r\n\r\n  state = {\r\n    mail: '',\r\n    password: '',\r\n    repassword: '',\r\n    code: '',\r\n    msg: '',\r\n    isDisable: false,\r\n    codeButtonText: '发送验证码'\r\n  }\r\n\r\n  timerId = null \r\n\r\n  handleChange = (name, value) => {\r\n    this.setState({ [name]: value })\r\n  }\r\n\r\n  register = async () => {\r\n    let { mail, password, repassword, code } = this.state\r\n\r\n    // 数据验证\r\n    if (!mail || !password || !repassword || !code) return this.setState({ msg: '请填写相应数据' }) \r\n    if (!isMail(mail)) return this.setState({ msg: '邮箱地址格式不正确' })\r\n    if (password.length < 6) return this.setState({ msg: '密码长度不能少于6位' })\r\n    if (password !== repassword) return this.setState({ msg: '两次密码不一致' })\r\n\r\n    // 注册用户，存储token到localstorage，跳转到主页\r\n    const { data } = await reqRegister({ mail, password, code })\r\n    if (data.err === 0) {\r\n      clearInterval(this.timerId)\r\n      this.props.history.replace('/login')\r\n    } else {\r\n      this.setState({ msg: data.msg })\r\n    }\r\n  }\r\n\r\n  toLogin = () => {\r\n    this.props.history.replace('/login')\r\n  }\r\n\r\n  getCode = async () => {\r\n    let { mail } = this.state \r\n\r\n    // 数据验证\r\n    if (!mail) return this.setState({ msg: '邮箱地址不能为空' }) \r\n    if (!isMail(mail)) return this.setState({ msg: '邮箱地址格式不正确' })\r\n\r\n    // 验证码重发倒计时1分钟\r\n    let time = 60\r\n    this.setState({ isDisable: true, codeButtonText: `重新发送(${time})` })\r\n    this.timerId = setInterval(() => {\r\n      time--\r\n      this.setState({ codeButtonText: `重新发送(${time})` })\r\n      if (time <= 0) {\r\n        clearInterval(this.timerId)\r\n        this.setState({ isDisable: false })\r\n        this.setState({ codeButtonText: '发送验证码' })\r\n      }\r\n    }, 1000)\r\n\r\n    // 发送请求获取验证码\r\n    const { data: { err, msg } } = await reqGetCode(mail)\r\n    if (err === 1) return this.setState({ msg })\r\n  }\r\n\r\n  handleNotiveBarClick = () => {\r\n    this.setState({ msg: '' })\r\n  }\r\n  \r\n  render() {\r\n    const { msg, isDisable, codeButtonText } = this.state\r\n    return (\r\n      <div>\r\n        <NavBar>便&nbsp;&nbsp;签</NavBar>\r\n        <Logo></Logo>\r\n        <WingBlank>\r\n          <List>\r\n            {msg ? <NoticeBar mode=\"closable\" onClick={this.handleNotiveBarClick}>{msg}</NoticeBar> : null}\r\n            <InputItem placeholder=\"请输入邮箱地址\" onChange={val => {this.handleChange('mail', val.trim())}}>邮箱:</InputItem>\r\n            <WhiteSpace/>\r\n            <InputItem placeholder=\"请输入密码\" type=\"password\" onChange={val => {this.handleChange('password', val.trim())}}>密码:</InputItem>\r\n            <WhiteSpace/>\r\n            <InputItem placeholder=\"请输入确认密码\" type=\"password\" onChange={val => this.handleChange('repassword', val.trim())}>确认密码:</InputItem>\r\n            <WhiteSpace/>\r\n            <Flex>\r\n              <FlexItem style={{flex: 2}}>\r\n                <InputItem placeholder=\"请输入验证码\" onChange={val => this.handleChange('code', val.trim())}>验证码:</InputItem>\r\n              </FlexItem>\r\n              <FlexItem>\r\n                <Button onClick={this.getCode} disabled={isDisable} style={{backgroundColor: '#057d9f', color: '#fff'}} activeStyle={{ backgroundColor:  '#06627d' }}>{codeButtonText}</Button>\r\n              </FlexItem>\r\n            </Flex>\r\n            <WhiteSpace/>\r\n            <Button type=\"primary\" onClick={this.register}>注&nbsp;&nbsp;&nbsp;册</Button>\r\n            <Button onClick={this.toLogin}>已有帐户</Button>\r\n          </List>\r\n        </WingBlank>\r\n    </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Register\r\n","import React, { Component } from 'react'\r\nimport { reqGetUser } from '../../api'\r\nimport { withRouter } from 'react-router-dom'\r\nimport { Icon } from 'antd-mobile'\r\n\r\nclass Authentication extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      user: ''\r\n    }  \r\n  }\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token')\r\n    if (!token) return this.props.history.replace('/login')\r\n    \r\n    reqGetUser()\r\n      .then(res => {\r\n        this.setState({ user: res.data})\r\n      })\r\n      .catch(err => {\r\n        this.props.history.replace('/login')\r\n      })\r\n  }\r\n\r\n  render() {\r\n    if (!this.state.user) {\r\n      return <div style={{ height: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center'}}><Icon type=\"loading\" size=\"lg\"/></div>\r\n    }\r\n    return (\r\n      <>\r\n        { this.props.children }\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Authentication)","export const inlineStyleButtons = [\r\n  {\r\n    value: 'Bold',\r\n    style: 'BOLD',\r\n    icon: 'icon-bold'\r\n  },\r\n  {\r\n    value: 'Italic',\r\n    style: 'ITALIC',\r\n    icon: 'icon-icon_italic'\r\n  },\r\n  {\r\n    value: 'Underline',\r\n    style: 'UNDERLINE',\r\n    icon: 'icon-under-line'\r\n  },\r\n  {\r\n    value: 'Strikethrough',\r\n    style: 'STRIKETHROUGH',\r\n    icon: 'icon-strike-through'\r\n  },\r\n  {\r\n    value: 'Code',\r\n    style: 'CODE',\r\n    icon: 'icon-code'\r\n  },\r\n  {\r\n    value: 'Highlight',\r\n    style: 'HIGHLIGHT',\r\n    icon: 'icon-highlight'\r\n  }\r\n]\r\n\r\nexport const blockTypeButtons = [\r\n  {\r\n    value: 'Heading One',\r\n    block: 'header-one',\r\n    icon: 'icon-h2'\r\n  },\r\n  {\r\n    value: 'Heading Two',\r\n    block: 'header-two',\r\n    icon: 'icon-h4'\r\n  },\r\n  {\r\n    value: 'Blockquote',\r\n    block: 'blockquote',\r\n    icon: 'icon-blockquote'\r\n  },\r\n  {\r\n    value: 'Unordered List',\r\n    block: 'unordered-list-item',\r\n    icon: 'icon-e-unorder-list'\r\n  },\r\n  {\r\n    value: 'Ordered List',\r\n    block: 'ordered-list-item',\r\n    icon: 'icon-e-order-list'\r\n  }\r\n];","import React from 'react'\r\nimport { inlineStyleButtons, blockTypeButtons } from './constants'\r\nimport { RichUtils } from 'draft-js'\r\nimport './style.less'\r\n\r\nfunction EditorToolBar(props) {\r\n  const { editorState, updateEditorState } = props\r\n\r\n  const renderInlineStyleButton = (value, style, icon) => {\r\n    const currentInlineStyle = editorState.getCurrentInlineStyle()\r\n    let className = ''\r\n    if (currentInlineStyle.has(style)) {\r\n      className = 'active'\r\n    }\r\n    return (\r\n      <div key={style} className={`icon-container ${className}`} data-style={style} onMouseDown={toggleInlineStyle}>\r\n        {icon ? <i className={`iconfont ${icon}`} /> : value}\r\n      </div>\r\n    )\r\n  }  \r\n\r\n  const renderBlockButton = (value, block, icon) => {\r\n    const currentBlockType = RichUtils.getCurrentBlockType(editorState)\r\n    let className = ''\r\n    if (currentBlockType === block) {\r\n      className = 'active'\r\n    }\r\n\r\n    return (\r\n      <span key={block} className={`icon-container ${className}`} data-block={block} onMouseDown={toggleBlockType}>\r\n        {icon ? <i className={`iconfont ${icon}`} /> : value}\r\n      </span>\r\n    )\r\n  }\r\n\r\n  const toggleInlineStyle = (event) => {\r\n    event.preventDefault()\r\n    let style = event.currentTarget.getAttribute('data-style')\r\n    updateEditorState(RichUtils.toggleInlineStyle(editorState, style))\r\n  }\r\n  \r\n  const toggleBlockType = (event) => {\r\n    event.preventDefault()\r\n    let block = event.currentTarget.getAttribute('data-block')\r\n    updateEditorState(RichUtils.toggleBlockType(editorState, block))\r\n  }\r\n  \r\n  return (\r\n    <div className=\"toolbar\">\r\n      { inlineStyleButtons.map(button => renderInlineStyleButton(button.value, button.style, button.icon))}\r\n      { blockTypeButtons.map(button => renderBlockButton(button.value, button.block, button.icon))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default EditorToolBar\r\n","import React, { Component } from 'react'\r\nimport { Editor, EditorState, RichUtils, KeyBindingUtil, getDefaultKeyBinding, convertToRaw, convertFromRaw, SelectionState } from 'draft-js'\r\nimport EditorToolBar from '../editor-toolbar'\r\nimport { NavBar, Icon, Toast } from 'antd-mobile'\r\nimport { formatTime } from '../../assets/js'\r\nimport { reqAddNote, reqUpdateNote, reqGetNote } from '../../api'\r\nimport './style.less'\r\n\r\nfunction keyBindingFunction(event) {\r\n  if (KeyBindingUtil.hasCommandModifier(event) && (event.key === 'x' || event.key === 'X')) {\r\n    return 'strikethrough'\r\n  }  \r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && (event.key === 'h' || event.key === 'H')) {\r\n    return 'highlight';\r\n  }\r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && event.key === '[') {\r\n    return 'header-one';\r\n  }\r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && event.key === ']') {\r\n    return 'header-two';\r\n  }\r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && event.key === '7') { \r\n    return 'blockquote';\r\n  }\r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && event.key === '8') {\r\n    return 'unordered-list';\r\n  }\r\n\r\n  if (KeyBindingUtil.hasCommandModifier(event) && event.key === '9') {\r\n    return 'ordered-list';\r\n  }\r\n\r\n  return getDefaultKeyBinding(event)\r\n\r\n}\r\n\r\nfunction moveSelectionToEnd(editorState) {\r\n  const content = editorState.getCurrentContent()\r\n  const blockMap = content.getBlockMap()\r\n  const key = blockMap.last().getKey()\r\n  const length = blockMap.last().getLength()\r\n  const selection = new SelectionState({\r\n      anchorKey: key,\r\n      anchorOffset: length,\r\n      focusKey: key,\r\n      focusOffset: length,\r\n  })\r\n  return EditorState.acceptSelection(editorState, selection)\r\n};\r\n\r\nclass ReactEditor extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.setDomEditorRef = ref => this.domEditor = ref\r\n    this.state = {\r\n      editorState: EditorState.createEmpty(),\r\n      updateTime: this.props.location.state,\r\n      isLoading: true,\r\n      resNoteId: ''\r\n    }\r\n  }\r\n\r\n  onChange = (editorState) => {\r\n    this.setState({ editorState })\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const id = this.props.match.params.id\r\n    if (id === 'add') {\r\n      return this.setState({\r\n        isLoading: false\r\n      })\r\n    }\r\n\r\n    const res = await reqGetNote({_id: id})\r\n    if (res.data.err === 0) {\r\n      const rawContentState = JSON.parse(res.data.data)\r\n      this.setState({\r\n        editorState:  EditorState.createWithContent(convertFromRaw(rawContentState)),\r\n        isLoading: false\r\n      })\r\n    } else {\r\n      this.props.history.replace('/404')\r\n    }\r\n  }\r\n\r\n  save = async () => {\r\n    const { editorState, resNoteId } = this.state\r\n    let _id = this.props.match.params.id\r\n    let category = this.props.match.params.category\r\n    const contentState = editorState.getCurrentContent()\r\n    const rawContentState =  convertToRaw(contentState)\r\n    const empty = rawContentState.blocks.every(row => row.text.trim() === '')\r\n\r\n    if (empty) return  Toast.info('empty !!!', 1);\r\n\r\n    if (_id === 'add' ) {\r\n      if (category === '全部分类') category = '未分类'\r\n      if (!resNoteId) {\r\n        const res = await reqAddNote({ rawContentState: JSON.stringify(rawContentState), category })\r\n        if (res.data.err === 0) {\r\n          this.setState({ resNoteId: res.data.data })\r\n          return Toast.success('添加成功', 1, ()=>{}, false)\r\n        }\r\n        return \r\n      } else {\r\n        _id = resNoteId\r\n      }\r\n    } \r\n\r\n    const res = await reqUpdateNote({ _id, rawContentState: JSON.stringify(rawContentState) })\r\n    if (res.data.err === 0) return Toast.success('更新成功', 1)\r\n\r\n    Toast.fail('保存失败', 1);\r\n    \r\n  }\r\n\r\n  updateEditorState = (editorState) => this.setState({editorState})\r\n  // 键盘监听\r\n  handleKeyCommand = (command) => {\r\n    let editorState = RichUtils.handleKeyCommand(this.state.editorState, command)\r\n\r\n    if (!editorState && command === 'strikethrough') {\r\n      editorState = RichUtils.toggleInlineStyle(this.state.editorState, 'STRIKETHROUGH')\r\n    }\r\n\r\n    if (!editorState && command === 'header-one') {\r\n      editorState = RichUtils.toggleBlockType(this.state.editorState, 'header-one')\r\n    }\r\n\r\n    if (!editorState && command === 'header-two') {\r\n      editorState = RichUtils.toggleBlockType(this.state.editorState, 'header-two')\r\n    }\r\n\r\n    if (!editorState && command === 'blockquote') {\r\n      editorState = RichUtils.toggleBlockType(this.state.editorState, 'blockquote');\r\n    }\r\n\r\n    if (!editorState && command === 'ordered-list') {\r\n      editorState = RichUtils.toggleBlockType(this.state.editorState, 'ordered-list-item');\r\n    }\r\n\r\n    if (!editorState && command === 'unordered-list') {\r\n      editorState = RichUtils.toggleBlockType(this.state.editorState, 'unordered-list-item');\r\n    }\r\n\r\n    if (!editorState && command === 'highlight') {\r\n      editorState = RichUtils.toggleInlineStyle(this.state.editorState, 'HIGHLIGHT');\r\n    }\r\n\r\n    if (editorState) {\r\n      this.setState({editorState})\r\n      return 'handled'\r\n    }\r\n\r\n    return 'not-handled'\r\n  }\r\n\r\n  undo = () => { this.setState({ editorState : EditorState.undo(this.state.editorState) }) }\r\n  redo = () => { this.setState({ editorState: EditorState.redo(this.state.editorState) }) }\r\n\r\n  focus = () => {\r\n    if(document.activeElement.contentEditable !== 'true') {\r\n      const editorState = moveSelectionToEnd(this.state.editorState) \r\n      this.setState({ editorState },()=>{ \r\n          this.domEditor.focus() \r\n      })      \r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { editorState, updateTime, isLoading } = this.state\r\n    // 自定义高亮style\r\n    const styleMap = {\r\n      'HIGHLIGHT': {\r\n        'backgroundColor': '#faed27'\r\n      }\r\n    }\r\n\r\n    // 解决playholder占位问题\r\n    const contentState = editorState.getCurrentContent()\r\n    let showPlaceholder = false \r\n    if (!contentState.hasText()) {\r\n      if (contentState.getBlockMap().first().getType() === 'unstyled') {\r\n        showPlaceholder = true\r\n      }\r\n    }\r\n\r\n    // 向前/后撤回图标颜色显示\r\n    let undoClassName = '',\r\n        redoClassName = ''\r\n\r\n    if (editorState.getUndoStack().size === 0) {\r\n      undoClassName = 'grey'\r\n    }\r\n    if (editorState.getRedoStack().size === 0) {\r\n      redoClassName = 'grey'\r\n    }\r\n\r\n    if (isLoading) {\r\n      return <div style={{textAlign: 'center', marginTop: 100, color: \"#777\"}}>Loading...</div>\r\n    }\r\n\r\n    const time = updateTime\r\n    return (\r\n      <div className={`editor-wrapper ${!showPlaceholder ? 'hide-placeholder' : ''}`}>\r\n        <div className=\"editor-header\">\r\n          <NavBar\r\n            mode=\"light\"\r\n            icon={<Icon type=\"left\" />}\r\n            onLeftClick={() => {this.props.history.push({ pathname: '/', category: this.props.match.params.category})}}\r\n            rightContent={[\r\n              <span key=\"0\" className={`iconfont icon-chehui ${undoClassName}`} onClick={this.undo} style={{marginRight: 15}}/>,\r\n              <span key=\"1\" className={`iconfont icon-qianjin ${redoClassName}`} onClick={this.redo} style={{marginRight: 15}}/>,\r\n              <span key=\"2\" className=\"iconfont icon-dui\" onClick={this.save}/> \r\n            ]}\r\n          >\r\n            <span className=\"edit-time\">{formatTime(time)}</span>\r\n          </NavBar>\r\n          <EditorToolBar editorState={editorState}  updateEditorState={this.updateEditorState}/>\r\n        </div>\r\n        <div className=\"editor-container\" onClick = {this.focus} >\r\n          <Editor \r\n            customStyleMap={styleMap}\r\n            editorState={editorState} \r\n            onChange={(event) => this.onChange(event)} \r\n            placeholder=\"write your note in ...\"\r\n            handleKeyCommand={this.handleKeyCommand}\r\n            keyBindingFn={keyBindingFunction}  \r\n            ref={this.setDomEditorRef}\r\n          />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ReactEditor","import React, { Component } from 'react'\r\nimport { Flex, Button } from 'antd-mobile'\r\n\r\nclass NotFound extends Component {\r\n  render() {\r\n    return (\r\n      <Flex justify=\"center\" align=\"center\" direction=\"column\" style={{height: '100vh'}}>\r\n        <div style={{fontSize: 100, fontWeight: 30, color: 'red', fontFamily: 'cursive'}}>404</div>\r\n        <Button type=\"ghost\" inline={true} onClick={() => this.props.history.replace('/')}>返回首页</Button>\r\n      </Flex>\r\n    )\r\n  }\r\n}\r\n\r\nexport default NotFound","import React, { Component } from 'react'\r\nimport { Route, Switch } from 'react-router-dom'\r\nimport Authentication from '../authentication'\r\nimport NoteList from '../note-list'\r\nimport Editor from '../editor'\r\nimport NotFound from '../not-found'\r\n\r\nclass Main extends Component {\r\n  state = {\r\n    user: ''\r\n  }\r\n  render() {\r\n    return (\r\n      <Authentication>\r\n        <Switch>\r\n          <Route path=\"/editor/:category/:id\" exact component={Editor}></Route>\r\n          <Route path=\"/\" exact component={NoteList}></Route>\r\n          <Route path='*' exact component={NotFound} />\r\n        </Switch>\r\n      </Authentication>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Main\r\n","import React, { Component } from 'react'\r\nimport { WhiteSpace, WingBlank, InputItem, Button, List, NavBar, Flex, NoticeBar } from 'antd-mobile'\r\nimport Logo from '../logo'\r\nimport { reqGetCode, reqReset } from '../../api'\r\nimport { isMail } from '../../assets/js'\r\n\r\nconst FlexItem = Flex.Item\r\n\r\nclass Reset extends Component {\r\n\r\n  state = {\r\n    mail: '',\r\n    password: '',\r\n    repassword: '',\r\n    code: '',\r\n    msg: '',\r\n    isDisable: false,\r\n    codeButtonText: '发送验证码'\r\n  }\r\n\r\n  timerId = null \r\n\r\n  handleChange = (name, value) => {\r\n    this.setState({ [name]: value })\r\n  }\r\n\r\n  reset = async () => {\r\n    let { mail, password, repassword, code } = this.state\r\n\r\n    if (!mail || !password || !repassword || !code) return this.setState({ msg: '请填写相应数据' }) \r\n    if (!isMail(mail)) return this.setState({ msg: '邮箱地址格式不正确' })\r\n    if (password.length < 6) return this.setState({ msg: '密码长度不能少于6位' })\r\n    if (password !== repassword) return this.setState({ msg: '两次密码不一致' })\r\n    \r\n    const { data } = await reqReset({ mail, password, code })\r\n    if (data.err === 0) {\r\n      clearInterval(this.timerId)\r\n      this.props.history.replace('/login')\r\n    } else {\r\n      this.setState({ msg: data.msg })\r\n    }\r\n  }\r\n\r\n  toLogin = () => {\r\n    this.props.history.replace('/login')\r\n  }\r\n\r\n  toRegister = () => {\r\n    this.props.history.replace('/register')\r\n  }\r\n\r\n  getCode = async () => {\r\n    let { mail } = this.state \r\n\r\n    // 数据验证\r\n    if (!mail) return this.setState({ msg: '邮箱地址不能为空' }) \r\n    if (!isMail(mail)) return this.setState({ msg: '邮箱地址格式不正确' })\r\n\r\n    // 验证码重发倒计时1分钟\r\n    let time = 60\r\n    this.setState({ isDisable: true, codeButtonText: `重新发送(${time})` })\r\n    this.timerId = setInterval(() => {\r\n      time--\r\n      this.setState({ codeButtonText: `重新发送(${time})` })\r\n      if (time <= 0) {\r\n        clearInterval(this.timerId)\r\n        this.setState({ isDisable: false })\r\n        this.setState({ codeButtonText: '发送验证码' })\r\n      }\r\n    }, 1000)\r\n\r\n    // 发送请求获取验证码\r\n    const { data: { err, msg } } = await reqGetCode(mail)\r\n    if (err === 1) return this.setState({ msg })\r\n  }\r\n\r\n  handleNotiveBarClick = () => {\r\n    this.setState({ msg: '' })\r\n  }\r\n  \r\n  render() {\r\n    const { msg, isDisable, codeButtonText } = this.state\r\n    return (\r\n      <div>\r\n        <NavBar>便&nbsp;&nbsp;签</NavBar>\r\n        <Logo></Logo>\r\n        <WingBlank>\r\n          <List>\r\n            {msg ? <NoticeBar mode=\"closable\" onClick={this.handleNotiveBarClick}>{msg}</NoticeBar> : null}\r\n            <InputItem placeholder=\"请输入邮箱地址\" onChange={val => {this.handleChange('mail', val.trim())}}>邮箱:</InputItem>\r\n            <WhiteSpace/>\r\n            <InputItem placeholder=\"请输入密码\" type=\"password\" onChange={val => {this.handleChange('password', val.trim())}}>密码:</InputItem>\r\n            <WhiteSpace/>\r\n            <InputItem placeholder=\"请输入确认密码\" type=\"password\" onChange={val => this.handleChange('repassword', val.trim())}>确认密码:</InputItem>\r\n            <WhiteSpace/>\r\n            <Flex>\r\n              <FlexItem style={{flex: 2}}>\r\n                <InputItem placeholder=\"请输入验证码\" onChange={val => this.handleChange('code', val.trim())}>验证码:</InputItem>\r\n              </FlexItem>\r\n              <FlexItem>\r\n                <Button onClick={this.getCode} disabled={isDisable} style={{backgroundColor: '#057d9f', color: '#fff'}} activeStyle={{ backgroundColor:  '#06627d' }}>{codeButtonText}</Button>\r\n              </FlexItem>\r\n            </Flex>\r\n            <WhiteSpace/>\r\n            <Button type=\"primary\" onClick={this.reset}>重置密码</Button>\r\n            <div style={{ display: 'flex', justifyContent: 'space-around' }}>\r\n              <Button onClick={this.toRegister} style={{flex: 1, borderRadius: 0}} >前往注册</Button>\r\n              <Button onClick={this.toLogin} style={{flex: 1, borderRadius: 0}}>前往登录</Button>\r\n            </div>\r\n          </List>\r\n        </WingBlank>\r\n    </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Reset\r\n","import React from 'react'\r\nimport { render } from 'react-dom' \r\nimport { BrowserRouter } from 'react-router-dom'\r\nimport { Switch, Route } from 'react-router-dom'\r\nimport Login from './components/login'\r\nimport Register from './components/register'\r\nimport Main from './components/main'\r\nimport Reset from './components/reset'\r\nimport './assets/css/style.less'\r\n\r\nrender(\r\n  <BrowserRouter>\r\n    <Switch>\r\n      <Route path='/login' exact component={Login}/>\r\n      <Route path='/register' exact component={Register}/>\r\n      <Route path='/reset' exact component={Reset}/>\r\n      <Route component={Main}/>\r\n    </Switch>\r\n  </BrowserRouter>,\r\n  document.getElementById('root')\r\n)"],"sourceRoot":""}